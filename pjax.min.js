/* Pjax.js 0.3.0 | Copyright (c) 2017 Guilherme Nascimento (brcontainer@yahoo.com.br) | Released under the MIT license */
!function(e,t,n,a){"use strict";function r(e){return/^\d+$/.test(e)}function o(){y&&clearTimeout(y),E||(E=e.createElement("div"),E.className="pjax-loader pjax-hide",E.innerHTML='<div class="pjax-progress"></div>',e.body.appendChild(E)),E.classList.remove("pjax-hide"),E.classList.remove("pjax-end"),E.classList.add("pjax-start"),y=setTimeout(function(){E.classList.add("pjax-inload")},10)}function i(){y&&clearTimeout(y),E.classList.add("pjax-end"),y=setTimeout(function(){E.classList.remove("pjax-inload"),E.classList.add("pjax-hide")},1e3)}function s(e){var t=[];return[].slice.call(e.querySelectorAll("[name]")).forEach(function(e){e.name&&N.test(e.taName)&&t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}function l(n){if(t.DOMParser)return(new DOMParser).parseFromString(n,"text/html");var a=e.implementation.createHTMLDocument("");return-1!==n.toLowerCase().indexOf("<!doctype")?a.documentElement.innerHTML=n:a.body.innerHTML=n,a}function c(t){var n,a,r,o=[],i=t.childNodes;for(n=i.length-1;n>=0;n--)"TITLE"!==i[n].tagName&&o.push(i[n].outerHTML);for(i=e.head.childNodes,n=i.length-1;n>=0;n--)"TITLE"!==i[n].tagName&&(a=o.indexOf(i[n].outerHTML),-1===a?i[n].parentNode.removeChild(i[n]):o.splice(a,1));for(r=e.createElement("div"),r.innerHTML=o.join(""),i=r.childNodes,n=i.length-1;n>=0;n--)e.head.appendChild(i[n]);r=o=null}function u(e,t,n){if(O[e])for(var a=O[e],r=0;r<a.length;r++)a[r](t,n)}function d(e,t,n){if("function"==typeof t){O[e]||(O[e]=[]);var a=O[e];if(!n)return void a.push(t);for(var r=[],o=a.length-1;o>=0;o--)a[o]===t&&r.push(o);for(var o=r.length-1;o>=0;o--)a.splice(r[o],1)}}function p(n,a,o,i){var s,u=l(a),d=u.title||"",p=o.containers,f=r(o.scrollLeft)?o.scrollLeft:t.scrollX||t.pageXOffset,h=r(o.scrollTop)?o.scrollTop:t.scrollY||t.pageYOffset;if(i){var m={pjaxUrl:n,pjaxData:a,pjaxConfig:o};1===i?t.history.pushState(m,d,n.substring(D.length)):2===i&&t.history.replaceState(m,d,n.substring(D.length))}M.updatehead&&c(u.head),d&&(e.title=d);for(var v=0,g=p.length;g>v;v++)for(var L=e.querySelectorAll(p[v]),f=0,x=L.length;x>f;f++)s=u.body.querySelector(p[v]),s&&(L[0].innerHTML=s.innerHTML);t.scrollTo(f,h),u=p=null}function f(e,t){var n,a=e.getAttribute(t);if("true"===a||"false"===a)n="true"===a;else if(/^\[*.?\]$|^\{*.?\}$/.test(a))try{n=JSON.parse(a)}catch(r){}return n||a}function h(e){for(var t,n,a,r=JSON.parse(JSON.stringify(M)),o=["containers","updatecurrent","updatehead","loader","scroll-left","scroll-right","then","done","fail"],i=o.length-1;i>=0;i--)t=o[i],a=f(e,"pjax-"+t),a&&(n=t.toLowerCase().replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()}),r[n]=a);return r}function m(){S&&S.abort()}function v(e,t,n,a,r){m();var o=h(a);u("initiate",e,o);var i={"X-PJAX-Container":o.containers.join(","),"X-PJAX-URL":e,"X-PJAX":"true"};S=new XMLHttpRequest,S.open(n,e,!0);for(var s in i)S.setRequestHeader(s,i[s]);S.onreadystatechange=function(){if(4===this.readyState){var n=this.status;n>=200&&300>n||304===n?(p(e,this.responseText,o,t),u("done",e)):u("fail",e,n),u("then",e)}},S.send(r||"")}function g(e){var n,a,r="GET",o=null,i=e.target;if(i.matches(C))n=i.action;else if(i.matches(b))n=i.href;else{for(e.preventDefault();i.parentNode;){i=i.parentNode,"A"===i.tagName&&(a=i);break}if(!a)return;i=a,n=i.href}if(0===n.indexOf(D+"/")||n===D){if("FORM"===i.nodeName){if(r=String(i.method).toUpperCase(),"POST"===r&&!t.FormData)return;if("POST"!==r||"multipart/form-data"!==i.enctype)o=s(i),"POST"!==r&&(n=n.replace(/\?.*/g,""),o&&(n+="?"+o),o=null);else{if(!t.FormData)return;o=new FormData(i)}}return e.preventDefault(),n===String(t.location)&&"POST"!==r?(M.updatecurrent&&v(n,2,r,i,o),!1):(v(n,1,r,i,o),!1)}}function L(e){e.state&&e.state.pjaxUrl?(m(),p(e.state.pjaxUrl,e.state.pjaxData,e.state.pjaxConfig,!1)):v(String(t.location),2)}function x(n){if(/^http(|s):$/.test(t.location.protocol)){M={containers:["#pjax-container"],updatecurrent:!1,updatehead:!0,scrollLeft:0,scrollTop:0,loader:!0};for(var a in M)n&&n[a]&&(M[a]=n[a]);n=null,d("initiate",o),d("then",i),t.addEventListener("unload",m),t.addEventListener("popstate",L),e.addEventListener("click",g),e.addEventListener("submit",g),/^(interactive|complete)$/i.test(e.readyState)?j():e.addEventListener("DOMContentLoaded",j)}}function j(){var n=String(t.location);t.history.replaceState({pjaxUrl:n,pjaxData:e.documentElement.outerHTML,pjaxConfig:M},e.title,n.substring(D.length))}function T(){M&&(M.load&&(d("initiate",o,!0),d("then",i,!0)),e.removeEventListener("click",g),e.removeEventListener("submit",g),t.removeEventListener("unload",m),t.removeEventListener("popstate",L))}t.Pjax={supported:!t.history.pushState||!(t.DOMParser||e.implementation.createHTMLDocument),remove:T,start:x,on:function(e,t){d(e,t)},off:function(e,t){d(e,t,!0)}};var S,M,y,E,O={},D=t.location.protocol.replace(/:/g,"")+"://"+t.location.host,N=/^(input|textarea|select|datalist|button|output)$/i,C="form:not([data-pjax-ignore]):not([action^='javascript:'])",b="a:not([data-pjax-ignore]):not([href^='#']):not([href^='javascript:'])";n.matches||(n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t[n]!==this;);return n>-1})}(document,window,Element.prototype);
