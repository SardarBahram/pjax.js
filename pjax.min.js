/* Pjax.js 0.5.1 | Copyright (c) 2017 Guilherme Nascimento (brcontainer@yahoo.com.br) | Released under the MIT license */

!function(e,t,n){"use strict";function a(e){return/^\d+$/.test(e)}function r(){if(D)return clearTimeout(D),D=0,O.className="pjax-loader pjax-hide",void setTimeout(r,20);O||((O=e.createElement("div")).innerHTML='<div class="pjax-progress"></div>',e.body.appendChild(O)),O.className="pjax-loader pjax-start",D=setTimeout(function(){D=0,O.className+=" pjax-inload"},10)}function o(){D&&clearTimeout(D),O.className+=" pjax-end",D=setTimeout(function(){D=0,O.className+=" pjax-hide"},1e3)}function i(e){var t=[];return[].slice.call(e.querySelectorAll("[name]")).forEach(function(e){e.name&&F.test(e.tagName)&&t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}function l(t){if(X)return(new DOMParser).parseFromString(t,"text/html");var n=e.implementation.createHTMLDocument("");return/^(\s+|)(<\!doctype|<html([^>]+>|>))/i.test(t)?(n.documentElement.innerHTML=t,n.body&&n.head||(n=e.implementation.createHTMLDocument("")).write(t)):n.body.innerHTML=t,n}function c(t){var n,a,r,o=[],i=t.childNodes;for(n=i.length-1;n>=0;n--)"TITLE"!==i[n].tagName&&o.push(i[n].outerHTML);for(n=(i=e.head.childNodes).length-1;n>=0;n--)"TITLE"!==i[n].tagName&&(-1===(a=o.indexOf(i[n].outerHTML))?i[n].parentNode.removeChild(i[n]):o.splice(a,1));for((r=e.createElement("div")).innerHTML=o.join(""),n=(i=r.childNodes).length-1;n>=0;n--)e.head.appendChild(i[n]);r=o=null}function s(e,t,n,a){if(k[e])for(var r=k[e],o=0;o<r.length;o++)r[o](t,n,a)}function u(e,t,n){if("function"==typeof t){k[e]||(k[e]=[]);var a=k[e];if(n){var r,o=[];for(r=a.length-1;r>=0;r--)a[r]===t&&o.push(r);for(r=o.length-1;r>=0;r--)a.splice(o[r],1)}else a.push(t)}}function f(n,r,o,i){var u,f=l(r),d=f.title||"",p=o.containers,h=a(o.scrollLeft)?o.scrollLeft:t.scrollX||t.pageXOffset,m=a(o.scrollTop)?o.scrollTop:t.scrollY||t.pageYOffset;if(i){var v={pjaxUrl:n,pjaxData:r,pjaxConfig:o};1===i?(C.pushState(v,d,n),U=!0,C.go(-1),setTimeout(function(){n!==t.location+""&&C.go(1),U=!1},50)):2===i&&C.replaceState(v,d,n)}if(!k.dom||!1!==s("dom",n,f)){o.updatehead&&f.head&&c(f.head),e.title=d;for(var g=p.length-1;g>=0;g--)(u=f.body.querySelector(p[g]))&&[].slice.call(e.querySelectorAll(p[g])).forEach(function(e){e.innerHTML=u.innerHTML});t.scrollTo(h,m),f=p=null}}function d(e,t){var n,a=e.getAttribute("data-"+t);if("true"===a||"false"===a)return"true"===a;if(!isNaN(a))return parseFloat(a);if(/^\[[\s\S]+\]$|^\{[^:]+[:][\s\S]+\}$/.test(a))try{n=JSON.parse(a)}catch(e){}return n||a}function p(e){var t,n,a=JSON.parse(JSON.stringify(N)),r=["containers","updatecurrent","updatehead","loader","scroll-left","scroll-right","done","fail"];if(!e)return a;for(var o=r.length-1;o>=0;o--)(n=d(e,"pjax-"+(t=r[o])))&&(a[t.toLowerCase().replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})]=n);return a}function h(e,t,n,a){f(e,t,n,a),s("done",e),s("then",e),b&&new Function(b).call(w)}function m(e,t){s("fail",e,t),s("then",e),H&&new Function(H).call(w)}function v(){M&&M.abort(),H=b=n}function g(t){var n,a="_="+ +new Date;return P?(n=e.createElement("a")).href=t:n=new P(t),n.search+=n.search?"&"+a:"?"+a,t=n.toString(),n=null,t}function S(e,t,n,a,r){v();var o=p(a);if(b=o.done,H=o.fail,w=a,s("initiate",e,o),k.handler)s("handler",{url:e,state:t,method:n,element:a},o,h,m);else{var i={"X-PJAX-Container":o.containers.join(","),"X-PJAX-URL":e,"X-PJAX":"true"},l=N.proxy||e;N.nocache&&(l=g(e)),(M=new XMLHttpRequest).open(n,l,!0);for(var c in i)M.setRequestHeader(c,i[c]);M.onreadystatechange=function(){if(4===this.readyState){var n=this.status;n>=200&&n<300||304===n?h(e,this.responseText,o,t):m(e,n)}},M.send(r||"")}}function x(e){var t,n,a=e.target;if(a.matches(N.linkSelector))t=a.href;else{for(;a=a.parentNode;){"A"===a.tagName&&(n=a);break}if(!n||!n.matches(N.linkSelector))return;t=(a=n).href}j("GET",t,null,a,e)}function T(e){var n,a,r,o=e.target;if(o.matches(N.formSelector)&&("POST"!==(r=String(o.method).toUpperCase())||t.FormData)){if(n=o.action,"POST"!==r||"multipart/form-data"!==o.enctype)a=i(o),"POST"!==r&&(n=n.replace(/\?.*/g,""),a&&(n+="?"+a),a=null);else{if(!t.FormData)return;a=new FormData(o)}j(r,n,a,o,e)}}function j(e,n,a,r,o){if(0===n.indexOf(q+"/")||n===q)return o.preventDefault(),n===t.location+""&&"POST"!==e?(N.updatecurrent&&S(n,2,e,r,a),!1):(S(n,1,e,r,a),!1)}function L(e){!U&&e.state&&e.state.pjaxUrl&&(v(),f(e.state.pjaxUrl,e.state.pjaxData,e.state.pjaxConfig,!1),s("history",e.state.pjaxUrl,e.state))}function y(){var n=t.location+"",a=t.history.state;a&&a.pjaxUrl||C.replaceState({pjaxUrl:n,pjaxData:e.documentElement.outerHTML,pjaxConfig:N},e.title,n),u("initiate",r),u("then",o),t.addEventListener("unload",v),t.addEventListener("popstate",L)}function E(){N&&(N.load&&(u("initiate",r,!0),u("then",o,!0)),e.removeEventListener("click",x),e.removeEventListener("submit",T),t.removeEventListener("unload",v),t.removeEventListener("popstate",L))}var M,N,D,O,b,H,w,C=t.history,P=t.URL,U=!1,X=!!t.DOMParser,k={},A=t.Element&&t.Element.prototype,q=t.location.protocol.replace(/:/g,"")+"://"+t.location.host,F=/^(input|textarea|select|datalist|button|output)$/i;if(t.Pjax={supported:!(!A||!C.pushState||!t.DOMParser&&!e.implementation.createHTMLDocument),remove:E,start:function(n){if(/^http(|s):$/.test(t.location.protocol)&&t.Pjax.supported){E(),N={linkSelector:"a:not([data-pjax-ignore]):not([href^='#']):not([href^='javascript:'])",formSelector:"form:not([data-pjax-ignore]):not([action^='javascript:'])",containers:["#pjax-container"],updatecurrent:!1,updatehead:!0,scrollLeft:0,scrollTop:0,nocache:!1,loader:!0,proxy:""};for(var a in N)n&&a in n&&(N[a]=n[a]);n=null,N.linkSelector&&e.addEventListener("click",x),N.formSelector&&e.addEventListener("submit",T),/^(interactive|complete)$/.test(e.readyState)?y():e.addEventListener("DOMContentLoaded",y)}},request:function(e,t){S(e,t.replace?2:1,t.method,null,t.data)},on:function(e,t){u(e,t)},off:function(e,t){u(e,t,!0)}},X)try{var J=l("<html><head><title>1</title></head><body>1</body></html>");X=!!(J.head&&J.title&&J.body)}catch(e){X=!1}A&&!A.matches&&(A.matches=A.matchesSelector||A.mozMatchesSelector||A.msMatchesSelector||A.oMatchesSelector||A.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t[n]!==this;);return n>-1})}(document,window);
