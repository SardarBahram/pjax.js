/* Pjax.js 0.5.3 | Copyright (c) 2017 Guilherme Nascimento (brcontainer@yahoo.com.br) | Released under the MIT license */

!function(e,t,r){"use strict";function n(){return N?(clearTimeout(N),N=0,b.className="pjax-loader pjax-hide",void setTimeout(n,20)):(b||(b=e.createElement("div"),b.innerHTML='<div class="pjax-progress"></div>',e.body.appendChild(b)),b.className="pjax-loader pjax-start",void(N=setTimeout(function(){N=0,b.className+=" pjax-inload"},10)))}function a(){N&&clearTimeout(N),b.className+=" pjax-end",N=setTimeout(function(){N=0,b.className+=" pjax-hide"},1e3)}function o(e){var t=[];return[].slice.call(e.querySelectorAll("[name]")).forEach(function(e){e.name&&P.test(e.tagName)&&t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}function i(e){if(O)return(new DOMParser).parseFromString(e,"text/html");var t=w.createHTMLDocument("");return/^\s*<(\!doctype|html)[^>]*>/i.test(e)?(t.documentElement.innerHTML=e,t.body&&t.head||(t=w.createHTMLDocument(""),t.write(e))):t.body.innerHTML=e,t}function l(t){var r,n,a,o=[],i=t.children;for(r=i.length-1;r>=0;r--)"TITLE"!==i[r].tagName&&o.push(i[r].outerHTML);for(i=e.head.children,r=i.length-1;r>=0;r--)"TITLE"===i[r].tagName||d(i[r],"resource")||(n=o.indexOf(i[r].outerHTML),-1===n?i[r].parentNode.removeChild(i[r]):o.splice(n,1));for(a=e.createElement("div"),a.innerHTML=o.join(""),i=a.children,r=i.length-1;r>=0;r--)d(i[r],"resource")||e.head.appendChild(i[r]);a=o=null}function c(e,t,r,n){if(C[e])for(var a=C[e],o=0;o<a.length;o++)a[o](t,r,n)}function s(e,t,r){if("function"==typeof t){C[e]||(C[e]=[]);var n=C[e];if(!r)return void n.push(t);var a,o=[];for(a=n.length-1;a>=0;a--)n[a]===t&&o.push(a);for(a=o.length-1;a>=0;a--)n.splice(o[a],1)}}function u(r,n,a,o){var s,u=i(n),d=u.title||"",f=a.containers,p=a.scrollLeft>0?+a.scrollLeft:t.scrollX||t.pageXOffset,h=a.scrollTop>0?+a.scrollTop:t.scrollY||t.pageYOffset;if(o){var m={pjaxUrl:r,pjaxData:n,pjaxConfig:a};1===o?D.pushState(m,d,r):2===o&&D.replaceState(m,d,r)}if(!C.dom||c("dom",r,u)!==!1){a.updatehead&&u.head&&l(u.head),e.title=d;for(var v=f.length-1;v>=0;v--)s=u.body.querySelector(f[v]),s&&[].slice.call(e.querySelectorAll(f[v])).forEach(function(e){e.innerHTML=s.innerHTML});t.scrollTo(p,h),u=f=null}}function d(e,t){var r,n=e.getAttribute("data-pjax-"+t);if("true"===n||"false"===n)return"true"===n;if(!isNaN(n))return parseFloat(n);if(/^\[[\s\S]+\]$|^\{[^:]+[:][\s\S]+\}$/.test(n))try{r=JSON.parse(n)}catch(a){}return r||n}function f(e){var t,r,n,a=JSON.parse(JSON.stringify(M)),o=["containers","updatecurrent","updatehead","loader","scroll-left","scroll-right","done","fail"];if(!e)return a;for(var i=o.length-1;i>=0;i--)t=o[i],n=d(e,t),n&&(r=t.toLowerCase().replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}),a[r]=n);return a}function p(e,t,r,n,o,i){i&&u(e,i,t,r),c(i?"done":"fail",e),c("then",e),o&&new Function(o).call(n),t.loader&&a()}function h(){E&&E.abort()}function m(t){var r,n="_="+ +new Date;return H?(r=e.createElement("a"),r.href=t):r=new H(t),r.search+=r.search?"&"+n:"?"+n,t=r.toString(),r=null,t}function v(e,t,r,a,o){h();var i=f(a);if(c("initiate",e,i),i.loader&&n(),C.handler)return void c("handler",{url:e,state:t,method:r,element:a},i,p);var l={"X-PJAX-Container":i.containers.join(","),"X-PJAX-URL":e,"X-PJAX":"true"},s=M.proxy||e;M.nocache&&(s=m(e)),E=new XMLHttpRequest,E.open(r,s,!0);for(var u in l)E.setRequestHeader(u,l[u]);E.onreadystatechange=function(){if(4===this.readyState){var r=this.status;r>=200&&300>r||304===r?p(e,i,t,a,i.done,this.responseText):p(e,i,r,a,i.fail)}},E.send(o||"")}function S(e){if(0===e.button){var t,r,n=e.target;if(n.matches(M.linkSelector))t=n.href;else{for(;n=n.parentNode;){"A"===n.tagName&&(r=n);break}if(!r||!r.matches(M.linkSelector))return;n=r,t=n.href}x("GET",t,null,n,e)}}function g(e){var r,n,a,i=e.target;if(i.matches(M.formSelector)&&(a=String(i.method).toUpperCase(),"POST"!==a||t.FormData)){if(r=i.action,"POST"!==a||"multipart/form-data"!==i.enctype)n=o(i),"POST"!==a&&(r=r.replace(/\?.*/g,"")+"?",n&&(r+=n),n=null);else{if(!t.FormData)return;n=new FormData(i)}x(a,r,n,i,e)}}function x(e,r,n,a,o){return 0===r.indexOf(U+"/")||r===U?(o.preventDefault(),r===t.location+""&&"POST"!==e?void(M.updatecurrent&&v(r,2,e,a,n)):void v(r,1,e,a,n)):void 0}function j(e){e.state&&e.state.pjaxUrl&&(h(),u(e.state.pjaxUrl,e.state.pjaxData,e.state.pjaxConfig,!1),c("history",e.state.pjaxUrl,e.state))}function L(){if(!X){X=!1;var r=t.location+"",n=t.history.state;n&&n.pjaxUrl||D.replaceState({pjaxUrl:r,pjaxData:e.documentElement.outerHTML,pjaxConfig:M},e.title,r),t.addEventListener("unload",h),t.addEventListener("popstate",j),M.linkSelector&&e.addEventListener("click",S),M.formSelector&&e.addEventListener("submit",g)}}function T(){M&&X&&(e.removeEventListener("click",S),e.removeEventListener("submit",g),t.removeEventListener("unload",h),t.removeEventListener("popstate",j),X=!1,M=r)}function y(r){if(/^http(|s):$/.test(t.location.protocol)&&t.Pjax.supported){T(),M={linkSelector:"a:not([data-pjax-ignore]):not([href^='#']):not([href^='javascript:'])",formSelector:"form:not([data-pjax-ignore]):not([action^='javascript:'])",containers:["#pjax-container"],updatecurrent:!1,updatehead:!0,scrollLeft:0,scrollTop:0,nocache:!1,loader:!0,proxy:""};for(var n in M)r&&n in r&&(M[n]=r[n]);r=null,/^(interactive|complete)$/.test(e.readyState)?L():e.addEventListener("DOMContentLoaded",L)}}var E,M,N,b,D=t.history,H=t.URL,O=!!t.DOMParser,C={},w=e.implementation,U=t.location.protocol.replace(/:/g,"")+"://"+t.location.host,P=/^(input|textarea|select|datalist|button|output)$/i,X=!1,k=t.Element&&t.Element.prototype;if(t.Pjax={supported:!!(k&&D.pushState&&(O||w&&w.createHTMLDocument)),remove:T,start:y,request:function(e,t){v(e,t.replace?2:1,t.method,null,t.data)},on:function(e,t){s(e,t)},off:function(e,t){s(e,t,!0)}},O)try{var A=i("<html><head><title>1</title></head><body>1</body></html>");O=!!(A.head&&A.title&&A.body)}catch(q){O=!1}k&&!k.matches&&(k.matches=k.matchesSelector||k.mozMatchesSelector||k.msMatchesSelector||k.oMatchesSelector||k.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;--r>=0&&t[r]!==this;);return r>-1})}(document,window);
