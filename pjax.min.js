/* Pjax.js 0.4.1 | Copyright (c) 2017 Guilherme Nascimento (brcontainer@yahoo.com.br) | Released under the MIT license */

!function(e,t,n){"use strict";function a(e){return/^\d+$/.test(e)}function r(){O&&clearTimeout(O),D||(D=e.createElement("div"),D.className="pjax-loader pjax-hide",D.innerHTML='<div class="pjax-progress"></div>',e.body.appendChild(D)),D.className=D.className.replace(J,"").replace($,"")+" pjax-start",O=setTimeout(function(){D.className+=" pjax-inload"},10)}function o(){O&&clearTimeout(O),D.className+=" pjax-end",O=setTimeout(function(){D.className=D.className.replace(F,"")+" pjax-hide"},1e3)}function i(e){var t=[];return[].slice.call(e.querySelectorAll("[name]")).forEach(function(e){e.name&&q.test(e.tagName)&&t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}function l(n){if(U&&t.DOMParser)return(new DOMParser).parseFromString(n,"text/html");var a=e.implementation.createHTMLDocument("");return/^(<\!doctype|<html([^>]+>|>))/i.test(n.trim())?a.write(n):a.body.innerHTML=n,a}function c(t){var n,a,r,o=[],i=t.childNodes;for(n=i.length-1;n>=0;n--)"TITLE"!==i[n].tagName&&o.push(i[n].outerHTML);for(i=e.head.childNodes,n=i.length-1;n>=0;n--)"TITLE"!==i[n].tagName&&(a=o.indexOf(i[n].outerHTML),-1===a?i[n].parentNode.removeChild(i[n]):o.splice(a,1));for(r=e.createElement("div"),r.innerHTML=o.join(""),i=r.childNodes,n=i.length-1;n>=0;n--)e.head.appendChild(i[n]);r=o=null}function s(e,t,n,a){if(X[e])for(var r=X[e],o=0;o<r.length;o++)r[o](t,n,a)}function u(e,t,n){if("function"==typeof t){X[e]||(X[e]=[]);var a=X[e];if(!n)return void a.push(t);var r,o=[];for(r=a.length-1;r>=0;r--)a[r]===t&&o.push(r);for(r=o.length-1;r>=0;r--)a.splice(o[r],1)}}function p(n,r,o,i){var s,u=l(r);u||(U=!1,u=l(r));var p=u.title||"",f=o.containers,d=a(o.scrollLeft)?o.scrollLeft:t.scrollX||t.pageXOffset,h=a(o.scrollTop)?o.scrollTop:t.scrollY||t.pageYOffset;if(i){var m={pjaxUrl:n,pjaxData:r,pjaxConfig:o};1===i?(b.pushState(m,p,n),w=!0,b.go(-1),setTimeout(function(){n!==String(t.location)&&(b.go(1),w=!1)},20)):2===i&&b.replaceState(m,p,n)}o.updatehead&&u.head&&c(u.head),e.title=p;for(var v=f.length-1;v>=0;v--){var g=e.querySelectorAll(f[v]);if(s=u.body.querySelector(f[v]))for(var x=g.length-1;x>=0;x--)g[x].innerHTML=s.innerHTML}t.scrollTo(d,h),u=f=null}function f(e,t){var n,a=e.getAttribute("data-"+t);if("true"===a||"false"===a)n="true"===a;else if(/^\[*.?\]$|^\{*.?\}$/.test(a))try{n=JSON.parse(a)}catch(r){}return n||a}function d(e){for(var t,n,a,r=JSON.parse(JSON.stringify(E)),o=["containers","updatecurrent","updatehead","loader","scroll-left","scroll-right","done","fail"],i=o.length-1;i>=0;i--)t=o[i],a=f(e,"pjax-"+t),a&&(n=t.toLowerCase().replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()}),r[n]=a);return r}function h(e,t,n,a){p(e,t,n,a),s("done",e),s("then",e),C&&new Function(C).call(P)}function m(e,t){s("fail",e,t),s("then",e),H&&new Function(H).call(P)}function v(){N&&N.abort(),H=C=n}function g(e,t,n,a,r){v();var o=d(a);if(C=o.done,H=o.fail,P=a,s("initiate",e,o),X.handler)return void s("handler",{url:e,state:t,method:n,element:a},o,h,m);var i={"X-PJAX-Container":o.containers.join(","),"X-PJAX-URL":e,"X-PJAX":"true"};N=new XMLHttpRequest,N.open(n,E.proxy||e,!0);for(var l in i)N.setRequestHeader(l,i[l]);N.onreadystatechange=function(){if(4===this.readyState){var n=this.status;n>=200&&300>n||304===n?(h(e,this.responseText,o,t),s("done",e)):m(e,n)}},N.send(r||"")}function x(e){var t,n,a=e.target;if(a.matches(E.linkSelector))t=a.href;else{for(;a=a.parentNode;){"A"===a.tagName&&(n=a);break}if(!n||!n.matches(E.linkSelector))return;a=n,t=a.href}j("GET",t,null,a,e)}function S(e){var n,a,r,o=e.target;if(o.matches(E.formSelector)&&(r=String(o.method).toUpperCase(),"POST"!==r||t.FormData)){if(n=o.action,"POST"!==r||"multipart/form-data"!==o.enctype)a=i(o),"POST"!==r&&(n=n.replace(/\?.*/g,""),a&&(n+="?"+a),a=null);else{if(!t.FormData)return;a=new FormData(o)}j(r,n,a,o,e)}}function j(e,n,a,r,o){return 0===n.indexOf(A+"/")||n===A?(o.preventDefault(),n===String(t.location)&&"POST"!==e?(E.updatecurrent&&g(n,2,e,r,a),!1):(g(n,1,e,r,a),!1)):void 0}function T(e){!w&&e.state&&e.state.pjaxUrl&&(v(),p(e.state.pjaxUrl,e.state.pjaxData,e.state.pjaxConfig,!1),s("history",e.state.pjaxUrl,e.state))}function L(){var n=String(t.location);b.replaceState({pjaxUrl:n,pjaxData:e.documentElement.outerHTML,pjaxConfig:E},e.title,n.substring(A.length)),u("initiate",r),u("then",o),t.addEventListener("unload",v),t.addEventListener("popstate",T)}function y(){E&&(E.load&&(u("initiate",r,!0),u("then",o,!0)),e.removeEventListener("click",x),e.removeEventListener("submit",S),t.removeEventListener("unload",v),t.removeEventListener("popstate",T))}function M(n){if(/^http(|s):$/.test(t.location.protocol)&&t.Pjax.supported){y(),E={linkSelector:"a:not([data-pjax-ignore]):not([href^='#']):not([href^='javascript:'])",formSelector:"form:not([data-pjax-ignore]):not([action^='javascript:'])",containers:["#pjax-container"],updatecurrent:!1,updatehead:!0,scrollLeft:0,scrollTop:0,loader:!0,proxy:""};for(var a in E)n&&a in n&&(E[a]=n[a]);n=null,E.linkSelector&&e.addEventListener("click",x),E.formSelector&&e.addEventListener("submit",S),/^(interactive|complete)$/i.test(e.readyState)?L():e.addEventListener("DOMContentLoaded",L)}}var N,E,O,D,C,H,P,b=t.history,w=!0,U=!0,X={},k=t.Element&&t.Element.prototype,A=t.location.protocol.replace(/:/g,"")+"://"+t.location.host,q=/^(input|textarea|select|datalist|button|output)$/i,F=/pjax\-inload/g,J=/pjax\-hide/g,$=/pjax\-end/g;t.Pjax={supported:!(!k||!b.pushState||!t.DOMParser&&!e.implementation.createHTMLDocument),remove:y,start:M,on:function(e,t){u(e,t)},off:function(e,t){u(e,t,!0)}},k&&!k.matches&&(k.matches=k.matchesSelector||k.mozMatchesSelector||k.msMatchesSelector||k.oMatchesSelector||k.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t[n]!==this;);return n>-1})}(document,window);
